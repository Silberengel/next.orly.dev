Starting Nostr Relay Benchmark
Data Directory: /tmp/benchmark_next-orly-alloc_8
Events: 5000, Workers: 4, Duration: 30s
20250913114427235918 INF /tmp/benchmark_next-orly-alloc_8: All 0 tables opened in 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/levels.go:161 /build/pkg/database/logger.go:57
20250913114427236368 INF /tmp/benchmark_next-orly-alloc_8: Discard stats nextEmptySlot: 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/discard.go:55 /build/pkg/database/logger.go:57
20250913114427236420 INF /tmp/benchmark_next-orly-alloc_8: Set nextTxnTs to 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:358 /build/pkg/database/logger.go:57
20250913114427237054 INF (*types.Uint32)(0xc0000100f0)({
 value: (uint32) 1
})
 /build/pkg/database/migrations.go:65
20250913114427237113 INF migrating to version 1... /build/pkg/database/migrations.go:79

=== Starting test round 1/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 339.941208ms
Events/sec: 14708.43
Avg latency: 264.237µs
P90 latency: 347.802µs
P95 latency: 383.139µs
P99 latency: 447.141µs
Bottom 10% Avg latency: 399.688µs

=== Burst Pattern Test ===
Burst completed: 500 events in 496.639004ms
Burst completed: 500 events in 395.431081ms
Burst completed: 500 events in 411.025866ms
Burst completed: 500 events in 419.57678ms
Burst completed: 500 events in 489.269517ms
Burst completed: 500 events in 428.035789ms
Burst completed: 500 events in 476.345049ms
Burst completed: 500 events in 515.739514ms
Burst completed: 500 events in 414.702914ms
Burst completed: 500 events in 440.760343ms
Burst test completed: 5000 events in 9.501434093s
Events/sec: 526.24

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2500 reads in 23.63556576s
Combined ops/sec: 211.55

Pausing 10s before next round...

=== Starting test round 2/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 413.941287ms
Events/sec: 12079.01
Avg latency: 323.873µs
P90 latency: 436.851µs
P95 latency: 488.881µs
P99 latency: 650.429µs
Bottom 10% Avg latency: 522.984µs

=== Burst Pattern Test ===
Burst completed: 500 events in 271.506837ms
Burst completed: 500 events in 361.931625ms
Burst completed: 500 events in 381.160975ms
Burst completed: 500 events in 310.403881ms
Burst completed: 500 events in 388.695936ms
Burst completed: 500 events in 323.300662ms
Burst completed: 500 events in 249.590375ms
Burst completed: 500 events in 318.935421ms
Burst completed: 500 events in 361.329644ms
Burst completed: 500 events in 474.806655ms
Burst test completed: 5000 events in 8.457868323s
Events/sec: 591.17

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2152 reads in 30.024551334s
Combined ops/sec: 154.94

================================================================================
BENCHMARK REPORT
================================================================================

Test: Peak Throughput
Duration: 339.941208ms
Total Events: 5000
Events/sec: 14708.43
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 142 MB
Avg Latency: 264.237µs
P90 Latency: 347.802µs
P95 Latency: 383.139µs
P99 Latency: 447.141µs
Bottom 10% Avg Latency: 399.688µs
----------------------------------------

Test: Burst Pattern
Duration: 9.501434093s
Total Events: 5000
Events/sec: 526.24
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 192 MB
Avg Latency: 182.339µs
P90 Latency: 240.387µs
P95 Latency: 270.195µs
P99 Latency: 333.575µs
Bottom 10% Avg Latency: 284.192µs
----------------------------------------

Test: Mixed Read/Write
Duration: 23.63556576s
Total Events: 5000
Events/sec: 211.55
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 199 MB
Avg Latency: 4.300403ms
P90 Latency: 8.510786ms
P95 Latency: 10.117687ms
P99 Latency: 12.490155ms
Bottom 10% Avg Latency: 10.404696ms
----------------------------------------

Test: Peak Throughput
Duration: 413.941287ms
Total Events: 5000
Events/sec: 12079.01
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 134 MB
Avg Latency: 323.873µs
P90 Latency: 436.851µs
P95 Latency: 488.881µs
P99 Latency: 650.429µs
Bottom 10% Avg Latency: 522.984µs
----------------------------------------

Test: Burst Pattern
Duration: 8.457868323s
Total Events: 5000
Events/sec: 591.17
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 185 MB
Avg Latency: 213.464µs
P90 Latency: 290.884µs
P95 Latency: 333.555µs
P99 Latency: 446.27µs
Bottom 10% Avg Latency: 360.86µs
----------------------------------------

Test: Mixed Read/Write
Duration: 30.024551334s
Total Events: 4652
Events/sec: 154.94
Success Rate: 93.0%
Concurrent Workers: 4
Memory Used: 137 MB
Avg Latency: 8.164383ms
P90 Latency: 17.857487ms
P95 Latency: 19.02409ms
P99 Latency: 21.306135ms
Bottom 10% Avg Latency: 19.344124ms
----------------------------------------

Report saved to: /tmp/benchmark_next-orly-alloc_8/benchmark_report.txt
AsciiDoc report saved to: /tmp/benchmark_next-orly-alloc_8/benchmark_report.adoc
20250913114629624246 INF /tmp/benchmark_next-orly-alloc_8: Lifetime L0 stalled for: 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:536 /build/pkg/database/logger.go:57
20250913114629944720 INF /tmp/benchmark_next-orly-alloc_8: 
Level 0 [ ]: NumTables: 00. Size: 0 B of 0 B. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 64 MiB
Level 1 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 2 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 3 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 4 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 5 [B]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 6 [ ]: NumTables: 01. Size: 22 MiB of 22 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 4.0 MiB
Level Done
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:615 /build/pkg/database/logger.go:57
20250913114629946593 INF /tmp/benchmark_next-orly-alloc_8: database closed /build/pkg/database/database.go:134

RELAY_NAME: next-orly-alloc
RELAY_URL: ws://next-orly-alloc:8080
TEST_TIMESTAMP: 2025-09-13T11:46:29+00:00
BENCHMARK_CONFIG:
  Events: 5000
  Workers: 4
  Duration: 30s
