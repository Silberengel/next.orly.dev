Starting Nostr Relay Benchmark
Data Directory: /tmp/benchmark_next-orly-mem_8
Events: 5000, Workers: 4, Duration: 30s
20250913114217371197 INF /tmp/benchmark_next-orly-mem_8: All 0 tables opened in 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/levels.go:161 /build/pkg/database/logger.go:57
20250913114217371717 INF /tmp/benchmark_next-orly-mem_8: Discard stats nextEmptySlot: 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/discard.go:55 /build/pkg/database/logger.go:57
20250913114217371747 INF /tmp/benchmark_next-orly-mem_8: Set nextTxnTs to 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:358 /build/pkg/database/logger.go:57
20250913114217372014 INF (*types.Uint32)(0xc0000100fc)({
 value: (uint32) 1
})
 /build/pkg/database/migrations.go:65
20250913114217372100 INF migrating to version 1... /build/pkg/database/migrations.go:79

=== Starting test round 1/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 353.88923ms
Events/sec: 14128.71
Avg latency: 273.836µs
P90 latency: 365.325µs
P95 latency: 397.186µs
P99 latency: 469.604µs
Bottom 10% Avg latency: 417.518µs

=== Burst Pattern Test ===
Burst completed: 500 events in 375.971522ms
Burst completed: 500 events in 446.782317ms
Burst completed: 500 events in 470.554433ms
Burst completed: 500 events in 491.456408ms
Burst completed: 500 events in 468.172794ms
Burst completed: 500 events in 408.391929ms
Burst completed: 500 events in 447.580014ms
Burst completed: 500 events in 457.169251ms
Burst completed: 500 events in 479.515284ms
Burst completed: 500 events in 474.094546ms
Burst test completed: 5000 events in 9.534688959s
Events/sec: 524.40

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2500 reads in 25.54544997s
Combined ops/sec: 195.73

Pausing 10s before next round...

=== Starting test round 2/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 369.402349ms
Events/sec: 13535.38
Avg latency: 289.113µs
P90 latency: 379.151µs
P95 latency: 412.575µs
P99 latency: 486.947µs
Bottom 10% Avg latency: 429.135µs

=== Burst Pattern Test ===
Burst completed: 500 events in 388.47726ms
Burst completed: 500 events in 367.258061ms
Burst completed: 500 events in 443.655199ms
Burst completed: 500 events in 364.303548ms
Burst completed: 500 events in 306.776349ms
Burst completed: 500 events in 305.273459ms
Burst completed: 500 events in 379.233497ms
Burst completed: 500 events in 377.586001ms
Burst completed: 500 events in 369.113691ms
Burst completed: 500 events in 333.996551ms
Burst test completed: 5000 events in 8.649351111s
Events/sec: 578.08

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 1996 reads in 30.025357572s
Combined ops/sec: 149.74

================================================================================
BENCHMARK REPORT
================================================================================

Test: Peak Throughput
Duration: 353.88923ms
Total Events: 5000
Events/sec: 14128.71
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 143 MB
Avg Latency: 273.836µs
P90 Latency: 365.325µs
P95 Latency: 397.186µs
P99 Latency: 469.604µs
Bottom 10% Avg Latency: 417.518µs
----------------------------------------

Test: Burst Pattern
Duration: 9.534688959s
Total Events: 5000
Events/sec: 524.40
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 192 MB
Avg Latency: 179.076µs
P90 Latency: 231.24µs
P95 Latency: 255.006µs
P99 Latency: 303.558µs
Bottom 10% Avg Latency: 269.293µs
----------------------------------------

Test: Mixed Read/Write
Duration: 25.54544997s
Total Events: 5000
Events/sec: 195.73
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 114 MB
Avg Latency: 5.044988ms
P90 Latency: 10.156837ms
P95 Latency: 11.501888ms
P99 Latency: 14.645443ms
Bottom 10% Avg Latency: 11.993477ms
----------------------------------------

Test: Peak Throughput
Duration: 369.402349ms
Total Events: 5000
Events/sec: 13535.38
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 132 MB
Avg Latency: 289.113µs
P90 Latency: 379.151µs
P95 Latency: 412.575µs
P99 Latency: 486.947µs
Bottom 10% Avg Latency: 429.135µs
----------------------------------------

Test: Burst Pattern
Duration: 8.649351111s
Total Events: 5000
Events/sec: 578.08
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 183 MB
Avg Latency: 201.741µs
P90 Latency: 263.752µs
P95 Latency: 297.136µs
P99 Latency: 358.212µs
Bottom 10% Avg Latency: 310.062µs
----------------------------------------

Test: Mixed Read/Write
Duration: 30.025357572s
Total Events: 4496
Events/sec: 149.74
Success Rate: 89.9%
Concurrent Workers: 4
Memory Used: 173 MB
Avg Latency: 8.802374ms
P90 Latency: 19.907605ms
P95 Latency: 22.490193ms
P99 Latency: 26.079898ms
Bottom 10% Avg Latency: 22.803343ms
----------------------------------------

Report saved to: /tmp/benchmark_next-orly-mem_8/benchmark_report.txt
AsciiDoc report saved to: /tmp/benchmark_next-orly-mem_8/benchmark_report.adoc
20250913114421864166 INF /tmp/benchmark_next-orly-mem_8: Lifetime L0 stalled for: 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:536 /build/pkg/database/logger.go:57
20250913114422185339 INF /tmp/benchmark_next-orly-mem_8: 
Level 0 [ ]: NumTables: 00. Size: 0 B of 0 B. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 64 MiB
Level 1 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 2 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 3 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 4 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 5 [B]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 6 [ ]: NumTables: 01. Size: 22 MiB of 22 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 4.0 MiB
Level Done
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:615 /build/pkg/database/logger.go:57
20250913114422187124 INF /tmp/benchmark_next-orly-mem_8: database closed /build/pkg/database/database.go:134

RELAY_NAME: next-orly-mem
RELAY_URL: ws://next-orly-mem:8080
TEST_TIMESTAMP: 2025-09-13T11:44:22+00:00
BENCHMARK_CONFIG:
  Events: 5000
  Workers: 4
  Duration: 30s
