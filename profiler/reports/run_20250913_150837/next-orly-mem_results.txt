Starting Nostr Relay Benchmark
Data Directory: /tmp/benchmark_next-orly-mem_8
Events: 5000, Workers: 4, Duration: 30s
20250913151046664505 INF /tmp/benchmark_next-orly-mem_8: All 0 tables opened in 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/levels.go:161 /build/pkg/database/logger.go:57
20250913151046665322 INF /tmp/benchmark_next-orly-mem_8: Discard stats nextEmptySlot: 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/discard.go:55 /build/pkg/database/logger.go:57
20250913151046665358 INF /tmp/benchmark_next-orly-mem_8: Set nextTxnTs to 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:358 /build/pkg/database/logger.go:57
20250913151046665590 INF (*types.Uint32)(0xc00013fc1c)({
 value: (uint32) 1
})
 /build/pkg/database/migrations.go:65
20250913151046665622 INF migrating to version 1... /build/pkg/database/migrations.go:79

=== Starting test round 1/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 347.207269ms
Events/sec: 14400.62
Avg latency: 269.084µs
P90 latency: 358.252µs
P95 latency: 390.313µs
P99 latency: 459.745µs
Bottom 10% Avg latency: 409.33µs

=== Burst Pattern Test ===
Burst completed: 500 events in 372.815911ms
Burst completed: 500 events in 385.472929ms
Burst completed: 500 events in 493.886155ms
Burst completed: 500 events in 499.001539ms
Burst completed: 500 events in 495.383911ms
Burst completed: 500 events in 463.681787ms
Burst completed: 500 events in 474.409848ms
Burst completed: 500 events in 507.35297ms
Burst completed: 500 events in 487.725706ms
Burst completed: 500 events in 473.3812ms
Burst test completed: 5000 events in 9.668130847s
Events/sec: 517.16

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2500 reads in 23.457777521s
Combined ops/sec: 213.15

Pausing 10s before next round...

=== Starting test round 2/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 363.793593ms
Events/sec: 13744.06
Avg latency: 284.695µs
P90 latency: 372.509µs
P95 latency: 405.031µs
P99 latency: 461.949µs
Bottom 10% Avg latency: 418.636µs

=== Burst Pattern Test ===
Burst completed: 500 events in 468.131728ms
Burst completed: 500 events in 466.05048ms
Burst completed: 500 events in 348.112373ms
Burst completed: 500 events in 399.633064ms
Burst completed: 500 events in 442.046507ms
Burst completed: 500 events in 381.168926ms
Burst completed: 500 events in 362.016406ms
Burst completed: 500 events in 379.297871ms
Burst completed: 500 events in 457.958442ms
Burst completed: 500 events in 455.557676ms
Burst test completed: 5000 events in 9.174541855s
Events/sec: 544.99

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2146 reads in 30.008115864s
Combined ops/sec: 154.82

================================================================================
BENCHMARK REPORT
================================================================================

Test: Peak Throughput
Duration: 347.207269ms
Total Events: 5000
Events/sec: 14400.62
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 143 MB
Avg Latency: 269.084µs
P90 Latency: 358.252µs
P95 Latency: 390.313µs
P99 Latency: 459.745µs
Bottom 10% Avg Latency: 409.33µs
----------------------------------------

Test: Burst Pattern
Duration: 9.668130847s
Total Events: 5000
Events/sec: 517.16
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 192 MB
Avg Latency: 178.033µs
P90 Latency: 225.098µs
P95 Latency: 255.165µs
P99 Latency: 318.015µs
Bottom 10% Avg Latency: 267.252µs
----------------------------------------

Test: Mixed Read/Write
Duration: 23.457777521s
Total Events: 5000
Events/sec: 213.15
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 103 MB
Avg Latency: 4.235413ms
P90 Latency: 8.39945ms
P95 Latency: 9.733877ms
P99 Latency: 12.359344ms
Bottom 10% Avg Latency: 10.173821ms
----------------------------------------

Test: Peak Throughput
Duration: 363.793593ms
Total Events: 5000
Events/sec: 13744.06
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 121 MB
Avg Latency: 284.695µs
P90 Latency: 372.509µs
P95 Latency: 405.031µs
P99 Latency: 461.949µs
Bottom 10% Avg Latency: 418.636µs
----------------------------------------

Test: Burst Pattern
Duration: 9.174541855s
Total Events: 5000
Events/sec: 544.99
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 174 MB
Avg Latency: 188.886µs
P90 Latency: 242.201µs
P95 Latency: 270.475µs
P99 Latency: 331.521µs
Bottom 10% Avg Latency: 287.008µs
----------------------------------------

Test: Mixed Read/Write
Duration: 30.008115864s
Total Events: 4646
Events/sec: 154.82
Success Rate: 92.9%
Concurrent Workers: 4
Memory Used: 184 MB
Avg Latency: 8.147241ms
P90 Latency: 17.076493ms
P95 Latency: 17.970006ms
P99 Latency: 24.424806ms
Bottom 10% Avg Latency: 19.866973ms
----------------------------------------

Report saved to: /tmp/benchmark_next-orly-mem_8/benchmark_report.txt
AsciiDoc report saved to: /tmp/benchmark_next-orly-mem_8/benchmark_report.adoc
20250913151249700098 INF /tmp/benchmark_next-orly-mem_8: Lifetime L0 stalled for: 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:536 /build/pkg/database/logger.go:57
20250913151250019024 INF /tmp/benchmark_next-orly-mem_8: 
Level 0 [ ]: NumTables: 00. Size: 0 B of 0 B. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 64 MiB
Level 1 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 2 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 3 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 4 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 5 [B]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 6 [ ]: NumTables: 01. Size: 22 MiB of 22 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 4.0 MiB
Level Done
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:615 /build/pkg/database/logger.go:57
20250913151250021227 INF /tmp/benchmark_next-orly-mem_8: database closed /build/pkg/database/database.go:134

RELAY_NAME: next-orly-mem
RELAY_URL: ws://next-orly-mem:8080
TEST_TIMESTAMP: 2025-09-13T15:12:50+00:00
BENCHMARK_CONFIG:
  Events: 5000
  Workers: 4
  Duration: 30s
