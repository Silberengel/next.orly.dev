Starting Nostr Relay Benchmark
Data Directory: /tmp/benchmark_next-orly-alloc_8
Events: 5000, Workers: 4, Duration: 30s
20250913151255068694 INF /tmp/benchmark_next-orly-alloc_8: All 0 tables opened in 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/levels.go:161 /build/pkg/database/logger.go:57
20250913151255069225 INF /tmp/benchmark_next-orly-alloc_8: Discard stats nextEmptySlot: 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/discard.go:55 /build/pkg/database/logger.go:57
20250913151255069261 INF /tmp/benchmark_next-orly-alloc_8: Set nextTxnTs to 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:358 /build/pkg/database/logger.go:57
20250913151255069538 INF (*types.Uint32)(0xc00001010c)({
 value: (uint32) 1
})
 /build/pkg/database/migrations.go:65
20250913151255069681 INF migrating to version 1... /build/pkg/database/migrations.go:79

=== Starting test round 1/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 339.504298ms
Events/sec: 14727.35
Avg latency: 264.477µs
P90 latency: 350.647µs
P95 latency: 382.538µs
P99 latency: 448.954µs
Bottom 10% Avg latency: 400.393µs

=== Burst Pattern Test ===
Burst completed: 500 events in 479.359678ms
Burst completed: 500 events in 425.596145ms
Burst completed: 500 events in 446.109496ms
Burst completed: 500 events in 378.033475ms
Burst completed: 500 events in 391.065418ms
Burst completed: 500 events in 409.089993ms
Burst completed: 500 events in 495.220448ms
Burst completed: 500 events in 493.489266ms
Burst completed: 500 events in 410.468883ms
Burst completed: 500 events in 418.819105ms
Burst test completed: 5000 events in 9.361610197s
Events/sec: 534.10

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2500 reads in 24.078024733s
Combined ops/sec: 207.66

Pausing 10s before next round...

=== Starting test round 2/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 358.887842ms
Events/sec: 13931.93
Avg latency: 280.856µs
P90 latency: 366.297µs
P95 latency: 394.952µs
P99 latency: 451.52µs
Bottom 10% Avg latency: 409.325µs

=== Burst Pattern Test ===
Burst completed: 500 events in 362.96011ms
Burst completed: 500 events in 416.140454ms
Burst completed: 500 events in 448.460564ms
Burst completed: 500 events in 474.76808ms
Burst completed: 500 events in 447.434655ms
Burst completed: 500 events in 427.462963ms
Burst completed: 500 events in 413.117609ms
Burst completed: 500 events in 442.349391ms
Burst completed: 500 events in 464.157823ms
Burst completed: 500 events in 472.898161ms
Burst test completed: 5000 events in 9.381865696s
Events/sec: 532.94

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2122 reads in 30.021046357s
Combined ops/sec: 153.96

================================================================================
BENCHMARK REPORT
================================================================================

Test: Peak Throughput
Duration: 339.504298ms
Total Events: 5000
Events/sec: 14727.35
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 142 MB
Avg Latency: 264.477µs
P90 Latency: 350.647µs
P95 Latency: 382.538µs
P99 Latency: 448.954µs
Bottom 10% Avg Latency: 400.393µs
----------------------------------------

Test: Burst Pattern
Duration: 9.361610197s
Total Events: 5000
Events/sec: 534.10
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 192 MB
Avg Latency: 183.763µs
P90 Latency: 236.69µs
P95 Latency: 269.453µs
P99 Latency: 328.425µs
Bottom 10% Avg Latency: 284.22µs
----------------------------------------

Test: Mixed Read/Write
Duration: 24.078024733s
Total Events: 5000
Events/sec: 207.66
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 105 MB
Avg Latency: 4.442571ms
P90 Latency: 8.682425ms
P95 Latency: 10.855199ms
P99 Latency: 12.949977ms
Bottom 10% Avg Latency: 10.754668ms
----------------------------------------

Test: Peak Throughput
Duration: 358.887842ms
Total Events: 5000
Events/sec: 13931.93
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 122 MB
Avg Latency: 280.856µs
P90 Latency: 366.297µs
P95 Latency: 394.952µs
P99 Latency: 451.52µs
Bottom 10% Avg Latency: 409.325µs
----------------------------------------

Test: Burst Pattern
Duration: 9.381865696s
Total Events: 5000
Events/sec: 532.94
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 175 MB
Avg Latency: 186.501µs
P90 Latency: 237.853µs
P95 Latency: 269.192µs
P99 Latency: 336.811µs
Bottom 10% Avg Latency: 287.769µs
----------------------------------------

Test: Mixed Read/Write
Duration: 30.021046357s
Total Events: 4622
Events/sec: 153.96
Success Rate: 92.4%
Concurrent Workers: 4
Memory Used: 129 MB
Avg Latency: 8.281607ms
P90 Latency: 17.758024ms
P95 Latency: 19.206379ms
P99 Latency: 24.13486ms
Bottom 10% Avg Latency: 20.330644ms
----------------------------------------

Report saved to: /tmp/benchmark_next-orly-alloc_8/benchmark_report.txt
AsciiDoc report saved to: /tmp/benchmark_next-orly-alloc_8/benchmark_report.adoc
20250913151458624980 INF /tmp/benchmark_next-orly-alloc_8: Lifetime L0 stalled for: 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:536 /build/pkg/database/logger.go:57
20250913151458946409 INF /tmp/benchmark_next-orly-alloc_8: 
Level 0 [ ]: NumTables: 00. Size: 0 B of 0 B. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 64 MiB
Level 1 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 2 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 3 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 4 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 5 [B]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 6 [ ]: NumTables: 01. Size: 22 MiB of 22 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 4.0 MiB
Level Done
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:615 /build/pkg/database/logger.go:57
20250913151458948689 INF /tmp/benchmark_next-orly-alloc_8: database closed /build/pkg/database/database.go:134

RELAY_NAME: next-orly-alloc
RELAY_URL: ws://next-orly-alloc:8080
TEST_TIMESTAMP: 2025-09-13T15:14:58+00:00
BENCHMARK_CONFIG:
  Events: 5000
  Workers: 4
  Duration: 30s
