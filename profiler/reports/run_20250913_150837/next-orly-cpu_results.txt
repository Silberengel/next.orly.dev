Starting Nostr Relay Benchmark
Data Directory: /tmp/benchmark_next-orly-cpu_8
Events: 5000, Workers: 4, Duration: 30s
20250913150837785506 INF /tmp/benchmark_next-orly-cpu_8: All 0 tables opened in 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/levels.go:161 /build/pkg/database/logger.go:57
20250913150837785985 INF /tmp/benchmark_next-orly-cpu_8: Discard stats nextEmptySlot: 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/discard.go:55 /build/pkg/database/logger.go:57
20250913150837786066 INF /tmp/benchmark_next-orly-cpu_8: Set nextTxnTs to 0
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:358 /build/pkg/database/logger.go:57
20250913150837786329 INF (*types.Uint32)(0xc0002b1cac)({
 value: (uint32) 1
})
 /build/pkg/database/migrations.go:65
20250913150837786374 INF migrating to version 1... /build/pkg/database/migrations.go:79

=== Starting test round 1/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 342.779064ms
Events/sec: 14586.66
Avg latency: 266.404µs
P90 latency: 354.213µs
P95 latency: 386.835µs
P99 latency: 459.934µs
Bottom 10% Avg latency: 404.279µs

=== Burst Pattern Test ===
Burst completed: 500 events in 423.591594ms
Burst completed: 500 events in 454.585716ms
Burst completed: 500 events in 486.007191ms
Burst completed: 500 events in 503.830553ms
Burst completed: 500 events in 433.97967ms
Burst completed: 500 events in 427.591978ms
Burst completed: 500 events in 500.38276ms
Burst completed: 500 events in 489.161258ms
Burst completed: 500 events in 474.350023ms
Burst completed: 500 events in 350.911595ms
Burst test completed: 5000 events in 9.557316818s
Events/sec: 523.16

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2500 reads in 24.103605311s
Combined ops/sec: 207.44

Pausing 10s before next round...

=== Starting test round 2/2 ===

=== Peak Throughput Test ===
Events saved: 5000/5000 (100.0%)
Duration: 372.362841ms
Events/sec: 13427.76
Avg latency: 291.441µs
P90 latency: 380.663µs
P95 latency: 417.233µs
P99 latency: 494.64µs
Bottom 10% Avg latency: 434.725µs

=== Burst Pattern Test ===
Burst completed: 500 events in 417.269185ms
Burst completed: 500 events in 468.354112ms
Burst completed: 500 events in 443.231977ms
Burst completed: 500 events in 435.358047ms
Burst completed: 500 events in 380.799007ms
Burst completed: 500 events in 322.904743ms
Burst completed: 500 events in 354.234969ms
Burst completed: 500 events in 390.690665ms
Burst completed: 500 events in 392.317202ms
Burst completed: 500 events in 467.071067ms
Burst test completed: 5000 events in 9.085471121s
Events/sec: 550.33

=== Mixed Read/Write Test ===
Pre-populating database for read tests...
Mixed test completed: 2500 writes, 2067 reads in 30.027760725s
Combined ops/sec: 152.09

================================================================================
BENCHMARK REPORT
================================================================================

Test: Peak Throughput
Duration: 342.779064ms
Total Events: 5000
Events/sec: 14586.66
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 142 MB
Avg Latency: 266.404µs
P90 Latency: 354.213µs
P95 Latency: 386.835µs
P99 Latency: 459.934µs
Bottom 10% Avg Latency: 404.279µs
----------------------------------------

Test: Burst Pattern
Duration: 9.557316818s
Total Events: 5000
Events/sec: 523.16
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 192 MB
Avg Latency: 181.633µs
P90 Latency: 225.639µs
P95 Latency: 258.311µs
P99 Latency: 332.341µs
Bottom 10% Avg Latency: 277.625µs
----------------------------------------

Test: Mixed Read/Write
Duration: 24.103605311s
Total Events: 5000
Events/sec: 207.44
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 108 MB
Avg Latency: 4.472533ms
P90 Latency: 8.862063ms
P95 Latency: 9.420264ms
P99 Latency: 12.991173ms
Bottom 10% Avg Latency: 10.293802ms
----------------------------------------

Test: Peak Throughput
Duration: 372.362841ms
Total Events: 5000
Events/sec: 13427.76
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 125 MB
Avg Latency: 291.441µs
P90 Latency: 380.663µs
P95 Latency: 417.233µs
P99 Latency: 494.64µs
Bottom 10% Avg Latency: 434.725µs
----------------------------------------

Test: Burst Pattern
Duration: 9.085471121s
Total Events: 5000
Events/sec: 550.33
Success Rate: 100.0%
Concurrent Workers: 4
Memory Used: 177 MB
Avg Latency: 191.41µs
P90 Latency: 247.551µs
P95 Latency: 282.246µs
P99 Latency: 336.099µs
Bottom 10% Avg Latency: 290.757µs
----------------------------------------

Test: Mixed Read/Write
Duration: 30.027760725s
Total Events: 4567
Events/sec: 152.09
Success Rate: 91.3%
Concurrent Workers: 4
Memory Used: 173 MB
Avg Latency: 8.526682ms
P90 Latency: 18.686774ms
P95 Latency: 21.052665ms
P99 Latency: 24.581304ms
Bottom 10% Avg Latency: 21.498913ms
----------------------------------------

Report saved to: /tmp/benchmark_next-orly-cpu_8/benchmark_report.txt
AsciiDoc report saved to: /tmp/benchmark_next-orly-cpu_8/benchmark_report.adoc
20250913151041289202 INF /tmp/benchmark_next-orly-cpu_8: Lifetime L0 stalled for: 0s
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:536 /build/pkg/database/logger.go:57
20250913151041613609 INF /tmp/benchmark_next-orly-cpu_8: 
Level 0 [ ]: NumTables: 00. Size: 0 B of 0 B. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 64 MiB
Level 1 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 2 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 3 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 4 [ ]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 5 [B]: NumTables: 00. Size: 0 B of 10 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 2.0 MiB
Level 6 [ ]: NumTables: 01. Size: 22 MiB of 22 MiB. Score: 0.00->0.00 StaleData: 0 B Target FileSize: 4.0 MiB
Level Done
/go/pkg/mod/github.com/dgraph-io/badger/v4@v4.8.0/db.go:615 /build/pkg/database/logger.go:57
20250913151041615724 INF /tmp/benchmark_next-orly-cpu_8: database closed /build/pkg/database/database.go:134

RELAY_NAME: next-orly-cpu
RELAY_URL: ws://next-orly-cpu:8080
TEST_TIMESTAMP: 2025-09-13T15:10:41+00:00
BENCHMARK_CONFIG:
  Events: 5000
  Workers: 4
  Duration: 30s
